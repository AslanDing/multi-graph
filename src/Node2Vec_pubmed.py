import os.path as osp

import matplotlib.pyplot as plt
import torch
print(torch.__version__)
print(torch.version.cuda)

from sklearn.manifold import TSNE

from torch_geometric.datasets import Planetoid
from torch_geometric.nn import Node2Vec

from scipy.io import loadmat
import numpy as np


batch_size = 64
learning_rate = 0.01

def main():
    data_dir = r'../exp/pubmed/data'
    data_path = data_dir + r'/PubMed_process.mat'
    datas = loadmat(data_path)

    A11 = datas['A11']

    train_list = datas['train_list']
    train_label = datas['train_label']

    test_list = datas['test_list']
    test_label = datas['test_label']

    A11sub = A11.nonzero()
    edge_index = torch.stack([torch.from_numpy(A11sub[0].astype(np.int64)),
                 torch.from_numpy(A11sub[1].astype(np.int64))], dim=0)

    #data = dataset[0]
    device = 'cuda' if torch.cuda.is_available() else 'cpu'
    model = Node2Vec(edge_index, embedding_dim=128, walk_length=20,
                     context_size=10,sparse=True).to(device)
                     #walks_per_node=10, num_negative_samples=1, p=1, q=1, sparse=True).to(device)

    loader = model.loader(batch_size=batch_size, shuffle=True, num_workers=4)
    optimizer = torch.optim.SparseAdam(list(model.parameters()), lr=learning_rate)

    def train():
        model.train()
        total_loss = 0
        #count = 0
        for pos_rw, neg_rw in loader:
            optimizer.zero_grad()
            loss = model.loss(pos_rw.to(device), neg_rw.to(device))
            loss.backward()
            optimizer.step()
            total_loss += loss.item()
            #print(count,loss.item())
            #count += 1
        return total_loss / len(loader)

    @torch.no_grad()
    def test():
        model.eval()
        z = model()
        acc,micro,macro = model.test(z[train_list], torch.from_numpy(train_label.reshape(-1)),
                         z[test_list], torch.from_numpy(test_label.reshape(-1)))
        # max_iter = 150
        return acc,micro,macro
    best_list = []
    bmic_list = []
    bmac_list = []
    for i in range(10):
        best = 0
        bmic = 0
        bmac = 0
        for epoch in range(1, 101):
            loss = train()
            acc,micro,macro = test()
            if acc>best:
                best = acc
            if bmic<micro:
                bmic = micro
            if bmac<macro:
                bmac = macro
            #print(f'Epoch: {epoch:02d}, Loss: {loss:.4f}, Acc: {acc:.4f}, Best:{best:.4f}, bmic:{bmic:.4f}, bmac:{bmac:.4f}')
        best_list.append(best)
        bmic_list.append(bmic)
        bmac_list.append(bmac)

    print(best_list)
    print(np.array(best_list).max())
    print(bmic_list)
    print(np.array(bmic_list).max())
    print(bmac_list)
    print(np.array(bmac_list).max())
    """
    [0.23255813953488372, 0.26744186046511625, 0.22093023255813954, 0.22093023255813954, 0.20930232558139536, 0.20930232558139536, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.23255813953488372]
    0.22209302325581395
    [0.23255813953488372, 0.26744186046511625, 0.22093023255813954, 0.22093023255813954, 0.20930232558139536, 0.20930232558139536, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.23255813953488372]
    0.22209302325581395
    [0.2081439393939394, 0.22324862764734243, 0.18409600502706014, 0.17393557422969186, 0.16610402268297006, 0.19576176384687022, 0.1849296536796537, 0.16908040969367627, 0.19579162667397962, 0.18227850778254004]
    0.18833701306577239
    
    [0.26744186046511625, 0.2441860465116279, 0.22093023255813954, 0.20930232558139536, 0.23255813953488372, 0.22093023255813954, 0.23255813953488372, 0.23255813953488372, 0.27906976744186046, 0.23255813953488372]
    0.2372093023255814
    [0.26744186046511625, 0.2441860465116279, 0.22093023255813954, 0.20930232558139536, 0.23255813953488372, 0.22093023255813954, 0.23255813953488372, 0.23255813953488372, 0.27906976744186046, 0.23255813953488372]
    0.2372093023255814
    [0.22657542322176466, 0.1889017392632521, 0.17293147109241078, 0.19691738355421218, 0.19790490555196438, 0.1749461482776277, 0.20126590463799768, 0.18531344523570933, 0.20443166582872466, 0.21074570853982622]
    0.19599337952034895
    """
    # @torch.no_grad()
    # def plot_points(colors):
    #     model.eval()
    #     z = model(torch.arange(data.num_nodes, device=device))
    #     z = TSNE(n_components=2).fit_transform(z.cpu().numpy())
    #     y = data.y.cpu().numpy()
    #
    #     plt.figure(figsize=(8, 8))
    #     for i in range(dataset.num_classes):
    #         plt.scatter(z[y == i, 0], z[y == i, 1], s=20, color=colors[i])
    #     plt.axis('off')
    #     plt.show()

    # colors = [
    #     '#ffc0cb', '#bada55', '#008080', '#420420', '#7fe5f0', '#065535',
    #     '#ffd700'
    # ]
    # plot_points(colors)


if __name__ == "__main__":
    batch_size_list = [ 64, 128, 256, 512]
    learning_rate_list = [0.01, 0.005, 0.008, 0.001, 0.0005]
    for batch_size_ in batch_size_list:
        for learning_rate_ in learning_rate_list:
            batch_size = batch_size_
            learning_rate = learning_rate_
            print(batch_size_, learning_rate_)
            main()
            print()

"""
32 0.01
[0.2441860465116279, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.23255813953488372, 0.36046511627906974, 0.20930232558139536, 0.22093023255813954, 0.26744186046511625, 0.20930232558139536]
0.36046511627906974
[0.2441860465116279, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.23255813953488372, 0.36046511627906974, 0.20930232558139536, 0.22093023255813954, 0.26744186046511625, 0.20930232558139536]
0.36046511627906974
[0.21018795886501837, 0.19353771228771227, 0.1773667931122292, 0.19324772449772448, 0.20012621436534478, 0.3195175039712855, 0.19571360153256706, 0.17385869565217393, 0.22146152017975973, 0.1923076923076923]
0.3195175039712855

32 0.005
[0.22093023255813954, 0.2558139534883721, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.19767441860465115, 0.2441860465116279, 0.26744186046511625, 0.23255813953488372, 0.29069767441860467]
0.29069767441860467
[0.22093023255813954, 0.2558139534883721, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.19767441860465115, 0.2441860465116279, 0.26744186046511625, 0.23255813953488372, 0.29069767441860467]
0.29069767441860467
[0.18404584773564142, 0.2349558451560955, 0.18361244019138756, 0.16437728937728938, 0.18037517249632018, 0.17331349206349206, 0.19747474747474747, 0.22632155426273073, 0.19479919023582914, 0.2399497732958099]
0.2399497732958099

32 0.008
[0.19767441860465115, 0.19767441860465115, 0.22093023255813954, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.26744186046511625, 0.29069767441860467, 0.19767441860465115, 0.2441860465116279]
0.29069767441860467
[0.19767441860465115, 0.19767441860465115, 0.22093023255813954, 0.22093023255813954, 0.19767441860465115, 0.20930232558139536, 0.26744186046511625, 0.29069767441860467, 0.19767441860465115, 0.2441860465116279]
0.29069767441860467
[0.1835840874811463, 0.17107610526728173, 0.20239898989898988, 0.20338217338217335, 0.1998371370793009, 0.18495955660801738, 0.24757022154047326, 0.24399112884020005, 0.2130856090153037, 0.21139734390018144]
0.24757022154047326

32 0.001
[0.1511627906976744, 0.11627906976744186, 0.12790697674418605, 0.12790697674418605, 0.11627906976744186, 0.13953488372093023, 0.12790697674418605, 0.1744186046511628, 0.18604651162790697, 0.19767441860465115]
0.19767441860465115
[0.1511627906976744, 0.11627906976744186, 0.12790697674418605, 0.12790697674418605, 0.11627906976744186, 0.13953488372093023, 0.12790697674418605, 0.1744186046511628, 0.18604651162790695, 0.19767441860465115]
0.19767441860465115
[0.10588023764853033, 0.07690047021943575, 0.08759920634920634, 0.08648477958822787, 0.07921052631578948, 0.08979223789006398, 0.09173347989137463, 0.1151403743315508, 0.13237751240847218, 0.15596631395780003]
0.15596631395780003

32 0.0005
[0.12790697674418605, 0.11627906976744186, 0.12790697674418605, 0.13953488372093023, 0.16279069767441862, 0.16279069767441862, 0.16279069767441862, 0.1744186046511628, 0.18604651162790697, 0.19767441860465115]
0.19767441860465115
[0.12790697674418605, 0.11627906976744186, 0.12790697674418605, 0.13953488372093023, 0.16279069767441862, 0.16279069767441862, 0.16279069767441862, 0.1744186046511628, 0.18604651162790695, 0.19767441860465115]
0.19767441860465115
[0.09864219114219114, 0.08454380764163372, 0.09112554112554111, 0.10517480820954825, 0.13521623865405463, 0.13539464411557436, 0.13830940988835727, 0.15485347985347986, 0.16059398845330858, 0.14936125965537728]
0.16059398845330858

64 0.01
[0.22093023255813954, 0.22093023255813954, 0.20930232558139536, 0.22093023255813954, 0.23255813953488372, 0.26744186046511625, 0.22093023255813954, 0.26744186046511625, 0.23255813953488372, 0.2441860465116279]
0.26744186046511625
[0.22093023255813954, 0.22093023255813954, 0.20930232558139536, 0.22093023255813954, 0.23255813953488372, 0.26744186046511625, 0.22093023255813954, 0.26744186046511625, 0.23255813953488372, 0.2441860465116279]
0.26744186046511625
[0.20740732711679627, 0.19296998221416828, 0.1919336139709167, 0.20113727858293076, 0.1832201323580634, 0.24721070548444687, 0.17812881562881563, 0.21299351086858306, 0.19064608370229813, 0.2011138704639111]
0.24721070548444687

64 0.005
[0.20930232558139536, 0.19767441860465115, 0.23255813953488372, 0.1744186046511628, 0.19767441860465115, 0.2441860465116279, 0.2441860465116279, 0.2441860465116279, 0.23255813953488372, 0.26744186046511625]
0.26744186046511625
[0.20930232558139536, 0.19767441860465115, 0.23255813953488372, 0.1744186046511628, 0.19767441860465115, 0.2441860465116279, 0.2441860465116279, 0.2441860465116279, 0.23255813953488372, 0.26744186046511625]
0.26744186046511625
[0.1932601484243071, 0.18401982356723737, 0.18960850732875906, 0.16728745791245792, 0.17003055379579768, 0.1863907810598987, 0.21683252508229822, 0.20170407896700998, 0.20602313486370158, 0.23932629072038353]
0.23932629072038353

64 0.01
[0.26744186046511625, 0.26744186046511625, 0.20930232558139536, 0.23255813953488372, 0.23255813953488372, 0.2441860465116279, 0.20930232558139536, 0.2558139534883721, 0.26744186046511625, 0.20930232558139536]
0.26744186046511625
[0.26744186046511625, 0.26744186046511625, 0.20930232558139536, 0.23255813953488372, 0.23255813953488372, 0.2441860465116279, 0.20930232558139536, 0.2558139534883721, 0.26744186046511625, 0.20930232558139536]
0.26744186046511625
[0.2133148964364935, 0.19974943023036462, 0.18461025054274482, 0.2032953596111491, 0.20329499354600777, 0.2115952792536811, 0.1742860276906067, 0.19265873015873014, 0.21974537407348158, 0.18488909396417136]
0.21974537407348158

64 0.005
[0.16279069767441862, 0.1744186046511628, 0.19767441860465115, 0.13953488372093023, 0.1744186046511628, 0.2441860465116279, 0.2558139534883721, 0.23255813953488372, 0.22093023255813954, 0.22093023255813954]
0.2558139534883721
[0.16279069767441862, 0.1744186046511628, 0.19767441860465115, 0.13953488372093023, 0.1744186046511628, 0.2441860465116279, 0.2558139534883721, 0.23255813953488372, 0.22093023255813954, 0.22093023255813954]
0.2558139534883721
[0.14131743156199678, 0.15534188034188035, 0.13981060606060605, 0.12287852905967961, 0.13384796238244515, 0.19298442685041112, 0.22753506655945677, 0.19859365808132412, 0.19007279227480467, 0.1897459580649236]
0.22753506655945677

64 0.008
[0.19767441860465115, 0.2441860465116279, 0.2441860465116279, 0.19767441860465115, 0.20930232558139536, 0.19767441860465115, 0.22093023255813954, 0.2558139534883721, 0.20930232558139536, 0.23255813953488372]
0.2558139534883721
[0.19767441860465115, 0.2441860465116279, 0.2441860465116279, 0.19767441860465115, 0.20930232558139536, 0.19767441860465115, 0.22093023255813954, 0.2558139534883721, 0.20930232558139536, 0.23255813953488372]
0.2558139534883721
[0.1496945156876784, 0.1951500018061626, 0.2215315934065934, 0.15441468253968255, 0.20878774680603948, 0.16133121264700212, 0.19494355556809703, 0.21741830065359477, 0.1744035674470457, 0.17926136363636364]
0.2215315934065934

64 0.001
[0.18604651162790697, 0.1511627906976744, 0.13953488372093023, 0.1511627906976744, 0.1744186046511628, 0.16279069767441862, 0.1511627906976744, 0.1744186046511628, 0.16279069767441862, 0.19767441860465115]
0.19767441860465115
[0.18604651162790695, 0.1511627906976744, 0.13953488372093023, 0.1511627906976744, 0.1744186046511628, 0.16279069767441862, 0.1511627906976744, 0.1744186046511628, 0.16279069767441862, 0.19767441860465115]
0.19767441860465115
[0.16332714702279919, 0.12615842490842494, 0.11387989203778678, 0.12158189033189032, 0.13241933455041188, 0.12025711600429645, 0.12607230392156862, 0.1422548040195099, 0.10551282051282052, 0.13558365769450675]
0.16332714702279919

64 0.0005
[0.12790697674418605, 0.10465116279069768, 0.12790697674418605, 0.12790697674418605, 0.13953488372093023, 0.13953488372093023, 0.13953488372093023, 0.13953488372093023, 0.16279069767441862, 0.13953488372093023]
0.16279069767441862
[0.12790697674418605, 0.10465116279069768, 0.12790697674418605, 0.12790697674418605, 0.13953488372093023, 0.13953488372093023, 0.13953488372093023, 0.13953488372093023, 0.16279069767441862, 0.13953488372093023]
0.16279069767441862
[0.08532125768967874, 0.07069640663390664, 0.09095479407979408, 0.08809523809523809, 0.09194015444015444, 0.10751342203548085, 0.10313718788950986, 0.11050135501355013, 0.13677045177045177, 0.11840277777777777]
0.13677045177045177

128 0.01
[0.19767441860465115, 0.2441860465116279, 0.20930232558139536, 0.23255813953488372, 0.20930232558139536, 0.2558139534883721, 0.22093023255813954, 0.27906976744186046, 0.3023255813953488, 0.2441860465116279]
0.3023255813953488
[0.19767441860465115, 0.2441860465116279, 0.20930232558139536, 0.23255813953488372, 0.20930232558139536, 0.2558139534883721, 0.22093023255813954, 0.27906976744186046, 0.3023255813953488, 0.2441860465116279]
0.3023255813953488
[0.16916694455614512, 0.2205942516155931, 0.19184432876116447, 0.2131492019884877, 0.19329816566124883, 0.21040402763734412, 0.19721108140225788, 0.26918363577822557, 0.22258852258852257, 0.19260241674034778]
0.26918363577822557

128 0.005
[0.23255813953488372, 0.2558139534883721, 0.23255813953488372, 0.26744186046511625, 0.2441860465116279, 0.20930232558139536, 0.22093023255813954, 0.20930232558139536, 0.23255813953488372, 0.23255813953488372]
0.26744186046511625
[0.23255813953488372, 0.2558139534883721, 0.23255813953488372, 0.26744186046511625, 0.2441860465116279, 0.20930232558139536, 0.22093023255813954, 0.20930232558139536, 0.23255813953488372, 0.23255813953488372]
0.26744186046511625
[0.19827213048962275, 0.2251082251082251, 0.18921807359307363, 0.21683040691192862, 0.18353748293321198, 0.1570755192579149, 0.19854435965573283, 0.18895745798319327, 0.2081435932221936, 0.2037133352283831]
0.2251082251082251

128 0.008
[0.1744186046511628, 0.19767441860465115, 0.23255813953488372, 0.2558139534883721, 0.2558139534883721, 0.23255813953488372, 0.2441860465116279, 0.22093023255813954, 0.18604651162790697, 0.19767441860465115]
0.2558139534883721
[0.1744186046511628, 0.19767441860465115, 0.23255813953488372, 0.2558139534883721, 0.2558139534883721, 0.23255813953488372, 0.2441860465116279, 0.22093023255813954, 0.18604651162790695, 0.19767441860465115]
0.2558139534883721
[0.16750676903675682, 0.16692370129870132, 0.20744164332399628, 0.22399264572439448, 0.20588196996053004, 0.16401444357007017, 0.20723565349688586, 0.17806259600614438, 0.16284121074434002, 0.16912352796415725]
0.22399264572439448

128 0.001
[0.12790697674418605, 0.13953488372093023, 0.16279069767441862, 0.16279069767441862, 0.1511627906976744, 0.13953488372093023, 0.16279069767441862, 0.13953488372093023, 0.13953488372093023, 0.18604651162790697]
0.18604651162790697
[0.12790697674418605, 0.13953488372093023, 0.16279069767441862, 0.16279069767441862, 0.1511627906976744, 0.13953488372093023, 0.16279069767441862, 0.13953488372093023, 0.13953488372093023, 0.18604651162790695]
0.18604651162790695
[0.11495726495726495, 0.1281669719169719, 0.1285811956361492, 0.13238324175824176, 0.1022897465437788, 0.0905364030254458, 0.10644666222773724, 0.09761697860962566, 0.09424603174603176, 0.13900959179864553]
0.13900959179864553

128 0.0005
[0.09302325581395349, 0.06976744186046512, 0.10465116279069768, 0.09302325581395349, 0.11627906976744186, 0.1511627906976744, 0.11627906976744186, 0.12790697674418605, 0.12790697674418605, 0.12790697674418605]
0.1511627906976744
[0.09302325581395347, 0.06976744186046512, 0.10465116279069768, 0.09302325581395347, 0.11627906976744186, 0.1511627906976744, 0.11627906976744186, 0.12790697674418605, 0.12790697674418605, 0.12790697674418605]
0.1511627906976744
[0.07571015585721468, 0.06551120448179272, 0.10791163493369377, 0.09096665181224005, 0.11016240703740704, 0.13424165924165926, 0.09641830870279146, 0.12182539682539684, 0.13128073582130712, 0.13128073582130712]
0.13424165924165926

256 0.01
[0.20930232558139536, 0.22093023255813954, 0.16279069767441862, 0.23255813953488372, 0.22093023255813954, 0.20930232558139536, 0.26744186046511625, 0.23255813953488372, 0.2441860465116279, 0.18604651162790697]
0.26744186046511625
[0.20930232558139536, 0.22093023255813954, 0.16279069767441862, 0.23255813953488372, 0.22093023255813954, 0.20930232558139536, 0.26744186046511625, 0.23255813953488372, 0.2441860465116279, 0.18604651162790695]
0.26744186046511625
[0.1643696581196581, 0.17005915280371803, 0.1373458421423538, 0.20990515771526003, 0.19650849998897538, 0.17736568986568985, 0.181318082788671, 0.2031926406926407, 0.2136674699745187, 0.16085854267711314]
0.2136674699745187

256 0.005
[0.1744186046511628, 0.1744186046511628, 0.1744186046511628, 0.20930232558139536, 0.20930232558139536, 0.19767441860465115, 0.20930232558139536, 0.18604651162790697, 0.20930232558139536, 0.20930232558139536]
0.20930232558139536
[0.1744186046511628, 0.1744186046511628, 0.1744186046511628, 0.20930232558139536, 0.20930232558139536, 0.19767441860465115, 0.20930232558139536, 0.18604651162790695, 0.20930232558139536, 0.20930232558139536]
0.20930232558139536
[0.15673075060063552, 0.12220879002793895, 0.13567059706765588, 0.16696044050695213, 0.14840214932126697, 0.14858694546194545, 0.15914380976050801, 0.17517825311942958, 0.17025116071798696, 0.17292912549466258]
0.17517825311942958

256 0.008
[0.2558139534883721, 0.26744186046511625, 0.2441860465116279, 0.22093023255813954, 0.20930232558139536, 0.19767441860465115, 0.23255813953488372, 0.29069767441860467, 0.23255813953488372, 0.23255813953488372]
0.29069767441860467
[0.2558139534883721, 0.26744186046511625, 0.2441860465116279, 0.22093023255813954, 0.20930232558139536, 0.19767441860465115, 0.23255813953488372, 0.29069767441860467, 0.23255813953488372, 0.23255813953488372]
0.29069767441860467
[0.1996043152109329, 0.21826063370181017, 0.20135971055088703, 0.16672131048007624, 0.18518772893772892, 0.18601190476190477, 0.19675005845218607, 0.2248151848151848, 0.20230616605616605, 0.16249308709899843]
0.2248151848151848

256 0.001
[0.20930232558139536, 0.20930232558139536, 0.20930232558139536, 0.1511627906976744, 0.19767441860465115, 0.18604651162790697, 0.1511627906976744, 0.16279069767441862, 0.12790697674418605, 0.13953488372093023]
0.20930232558139536
[0.20930232558139536, 0.20930232558139536, 0.20930232558139536, 0.1511627906976744, 0.19767441860465115, 0.18604651162790695, 0.1511627906976744, 0.16279069767441862, 0.12790697674418605, 0.13953488372093023]
0.20930232558139536
[0.17944054920920105, 0.18838461656666525, 0.18586156490568254, 0.1419460257221168, 0.16161270110760775, 0.15561936648524086, 0.0847452934662237, 0.09490306441525954, 0.06843292872704637, 0.09962406015037595]
0.18838461656666525

256 0.0005
[0.12790697674418605, 0.13953488372093023, 0.1511627906976744, 0.16279069767441862, 0.18604651162790697, 0.20930232558139536, 0.20930232558139536, 0.20930232558139536, 0.19767441860465115, 0.23255813953488372]
0.23255813953488372
[0.12790697674418605, 0.13953488372093023, 0.1511627906976744, 0.16279069767441862, 0.18604651162790695, 0.20930232558139536, 0.20930232558139536, 0.20930232558139536, 0.19767441860465115, 0.23255813953488372]
0.23255813953488372
[0.12157105715815669, 0.13695290616246497, 0.14650644638160867, 0.1499674160964483, 0.16325538200538198, 0.17947844674818358, 0.17878637566137567, 0.16995067005095887, 0.1774328626799557, 0.20227272727272727]
0.20227272727272727

512 0.01
[0.1511627906976744, 0.29069767441860467, 0.2441860465116279, 0.23255813953488372, 0.22093023255813954, 0.22093023255813954, 0.2441860465116279, 0.2558139534883721, 0.27906976744186046, 0.19767441860465115]
0.29069767441860467
[0.1511627906976744, 0.29069767441860467, 0.2441860465116279, 0.23255813953488372, 0.22093023255813954, 0.22093023255813954, 0.2441860465116279, 0.2558139534883721, 0.27906976744186046, 0.19767441860465115]
0.29069767441860467
[0.1475186272061272, 0.24467247369033082, 0.20448203757027286, 0.1769445466813888, 0.1855425622504111, 0.1711201298701299, 0.19650132275132276, 0.19391346012089045, 0.24353513202197413, 0.18979019239274658]
0.24467247369033082

512 0.005
[0.1744186046511628, 0.19767441860465115, 0.22093023255813954, 0.22093023255813954, 0.20930232558139536, 0.20930232558139536, 0.2441860465116279, 0.19767441860465115, 0.22093023255813954, 0.19767441860465115]
0.2441860465116279
[0.1744186046511628, 0.19767441860465115, 0.22093023255813954, 0.22093023255813954, 0.20930232558139536, 0.20930232558139536, 0.2441860465116279, 0.19767441860465115, 0.22093023255813954, 0.19767441860465115]
0.2441860465116279
[0.15299953314659195, 0.1492893679210815, 0.18344847648844845, 0.21235297049441787, 0.16441755083996462, 0.18944164412877423, 0.23020693749338714, 0.17586206896551726, 0.18410658255859497, 0.19584706959706957]
0.23020693749338714

512 0.008
[0.18604651162790697, 0.1744186046511628, 0.20930232558139536, 0.22093023255813954, 0.1744186046511628, 0.23255813953488372, 0.22093023255813954, 0.20930232558139536, 0.27906976744186046, 0.23255813953488372]
0.27906976744186046
[0.18604651162790695, 0.1744186046511628, 0.20930232558139536, 0.22093023255813954, 0.1744186046511628, 0.23255813953488372, 0.22093023255813954, 0.20930232558139536, 0.27906976744186046, 0.23255813953488372]
0.27906976744186046
[0.1393543956043956, 0.14272556711581103, 0.1868939393939394, 0.17316916969376925, 0.1482804232804233, 0.17664995822890558, 0.18346383149014728, 0.1911654135338346, 0.2588691438233772, 0.18566553966749938]
0.2588691438233772

512 0.001
[0.1744186046511628, 0.1511627906976744, 0.16279069767441862, 0.18604651162790697, 0.18604651162790697, 0.1744186046511628, 0.1744186046511628, 0.1744186046511628, 0.18604651162790697, 0.16279069767441862]
0.18604651162790697
[0.1744186046511628, 0.1511627906976744, 0.16279069767441862, 0.18604651162790695, 0.18604651162790695, 0.1744186046511628, 0.1744186046511628, 0.1744186046511628, 0.18604651162790695, 0.16279069767441862]
0.18604651162790695
[0.13645484949832776, 0.12431849551414768, 0.13457071383900654, 0.15648607690758853, 0.1510065015499798, 0.1364656367597544, 0.13282800646685736, 0.12812019969278032, 0.13780982554312046, 0.11697781385281386]
0.15648607690758853

512 0.0005
[0.08139534883720931, 0.06976744186046512, 0.08139534883720931, 0.08139534883720931, 0.09302325581395349, 0.09302325581395349, 0.10465116279069768, 0.09302325581395349, 0.09302325581395349, 0.09302325581395349]
0.10465116279069768
[0.08139534883720931, 0.06976744186046512, 0.08139534883720931, 0.08139534883720931, 0.09302325581395347, 0.09302325581395347, 0.10465116279069768, 0.09302325581395347, 0.09302325581395347, 0.09302325581395347]
0.10465116279069768
[0.07167065390749601, 0.05129892037786775, 0.05501443001443001, 0.05555555555555555, 0.0649549349059753, 0.08073870573870574, 0.08568896903370228, 0.0799220401691332, 0.08106060606060606, 0.08392857142857144]
0.08568896903370228
"""

